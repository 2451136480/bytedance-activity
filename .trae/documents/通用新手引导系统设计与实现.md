# 基于Intro.js的新手引导系统设计与实现

## 一、系统概述

使用Intro.js库实现通用新手引导系统，利用其成熟的步骤化引导功能，结合自定义配置实现多页面灵活部署。

## 二、核心实现步骤

### 1. 安装Intro.js
```bash
npm install intro.js
```

### 2. 目录结构
```
src/utils/guide/
├── IntroGuideManager.js    # Intro.js封装管理器
├── guideConfigs.js         # 引导配置文件
└── guide.css               # 自定义样式扩展
```

### 3. 配置文件设计
```javascript
// guideConfigs.js
export const guideConfigs = {
  home: {
    steps: [
      {
        element: '.activity-carousel',
        intro: '这是活动轮播区，展示重要活动',
        position: 'bottom'
      },
      {
        element: '.layout-switcher',
        intro: '点击切换布局视图',
        position: 'right'
      },
      {
        element: '.activity-grid',
        intro: '这是活动卡片列表，展示所有活动',
        position: 'top'
      }
    ],
    options: {
      tooltipPosition: 'auto',
      showButtons: true,
      showProgress: true,
      showBullets: true,
      overlayOpacity: 0.8,
      doneLabel: '完成',
      nextLabel: '下一步',
      prevLabel: '上一步',
      skipLabel: '跳过'
    }
  },
  activities: {
    steps: [
      {
        element: '.filter-bar',
        intro: '使用筛选条件查找活动',
        position: 'bottom'
      },
      {
        element: '.activity-list',
        intro: '活动列表，支持分页和排序',
        position: 'top'
      },
      {
        element: '.pagination',
        intro: '分页导航，浏览更多活动',
        position: 'top'
      }
    ],
    options: {
      // 列表页引导选项
    }
  }
};
```

### 4. 引导管理器实现
```javascript
// IntroGuideManager.js
import introJs from 'intro.js';
import 'intro.js/introjs.css';
import './guide.css';
import { guideConfigs } from './guideConfigs';

class IntroGuideManager {
  constructor() {
    this.currentGuide = null;
  }

  // 启动指定页面的引导
  startGuide(page) {
    const config = guideConfigs[page];
    if (!config) return;

    this.currentGuide = introJs();
    this.currentGuide.setOptions({
      ...config.options,
      steps: config.steps
    });

    this.currentGuide.start();
  }

  // 结束当前引导
  endGuide() {
    if (this.currentGuide) {
      this.currentGuide.exit();
      this.currentGuide = null;
    }
  }

  // 获取当前引导状态
  getCurrentGuide() {
    return this.currentGuide;
  }
}

export const guideManager = new IntroGuideManager();
```

### 5. 导航栏集成

修改`Layout.jsx`文件，在导航栏添加"新手指南"按钮：

```jsx
// 在navMenu数组中添加引导菜单
{
  id: 'guide',
  label: '新手指南',
  icon: '📚',
  onClick: () => guideManager.startGuide(getCurrentPage())
}

// 添加getCurrentPage辅助函数
const getCurrentPage = () => {
  const path = location.pathname;
  if (path === '/') return 'home';
  if (path.startsWith('/activities')) return 'activities';
  return 'home';
};
```

### 6. 页面集成

在需要引导的页面组件中，确保元素具有正确的class或id，以便Intro.js能够定位：

```jsx
// 示例：为活动轮播组件添加class
<div className="activity-carousel">
  {/* 轮播内容 */}
</div>
```

## 三、关键技术点

### 1. 元素定位
- 利用Intro.js内置的元素定位功能
- 支持CSS选择器直接定位元素
- 自动处理元素不存在的情况

### 2. 动态场景适配
- Intro.js内置支持响应式布局
- 元素位置变化时自动调整提示框位置
- 支持异步加载元素的延迟执行

### 3. 配置化管理
- 集中式配置文件管理所有引导流程
- 支持动态修改配置
- 支持多语言扩展（可选）

### 4. 持久化存储
- 使用localStorage存储引导完成状态
- 支持跳过引导后不再显示
- 支持重置引导状态

## 四、使用示例

### 1. 启动引导
```javascript
// 导航栏按钮点击事件
guideManager.startGuide('home');
```

### 2. 结束引导
```javascript
guideManager.endGuide();
```

### 3. 监听引导事件
```javascript
this.currentGuide.oncomplete(() => {
  console.log('引导完成');
  // 存储引导完成状态
  localStorage.setItem('guide_completed', 'true');
});
```

## 五、交付物

1. **IntroGuideManager.js**：Intro.js封装管理器
2. **guideConfigs.js**：引导配置文件
3. **guide.css**：自定义样式
4. **导航栏集成**：修改Layout.jsx添加引导入口
5. **使用文档**：简单的使用说明

## 六、预期效果

- ✅ 步骤化引导流程，支持多页面配置
- ✅ 与业务代码完全解耦，通过配置文件管理
- ✅ 导航栏集成引导入口
- ✅ 精确定位页面元素
- ✅ 动态适配不同场景
- ✅ 良好的用户体验
- ✅ 简单易用，易于扩展

这个方案利用了Intro.js的成熟功能，简化了开发过程，同时满足了用户的所有核心需求。